<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/frontend/src/components/ProtectedRoute.jsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/components/ProtectedRoute.jsx" />
              <option name="originalContent" value="// components/ProtectedRoute.jsx&#10;import { Navigate, useLocation } from 'react-router-dom';&#10;import { useAuth } from 'modules/auth/useAuth';&#10;import Loader from 'components/Loader';&#10;&#10;export default function ProtectedRoute({ children, roles = [], permissions = [] }) {&#10;  const { isAuthenticated, loading, hasRole, hasPermission } = useAuth();&#10;  const location = useLocation();&#10;&#10;  if (loading) return &lt;Loader /&gt;;&#10;&#10;  if (!isAuthenticated) return &lt;Navigate to=&quot;/auth/login&quot; state={{ from: location }} replace /&gt;;&#10;&#10;  const roleOK = roles.length === 0 || roles.some((r) =&gt; hasRole(r));&#10;  const permOK = permissions.length === 0 || permissions.some((p) =&gt; hasPermission(p));&#10;&#10;  if (roleOK &amp;&amp; permOK) return children;&#10;&#10;  return &lt;Navigate to=&quot;/unauthorized&quot; replace /&gt;;&#10;}&#10;" />
              <option name="updatedContent" value="// components/ProtectedRoute.jsx&#13;&#10;import { Navigate, useLocation } from 'react-router-dom';&#13;&#10;import useAuth from 'modules/auth/useAuth';&#13;&#10;import Loader from 'components/Loader';&#13;&#10;&#13;&#10;export default function ProtectedRoute({ children, roles = [], permissions = [] }) {&#13;&#10;  const { isAuthenticated, loading, hasRole, hasPermission } = useAuth();&#13;&#10;  const location = useLocation();&#13;&#10;&#13;&#10;  if (loading) return &lt;Loader /&gt;;&#13;&#10;&#13;&#10;  if (!isAuthenticated) return &lt;Navigate to=&quot;/auth/login&quot; state={{ from: location }} replace /&gt;;&#13;&#10;&#13;&#10;  // Grant access if any required role OR any required permission is satisfied&#13;&#10;  const hasAnyRole = roles.length === 0 || roles.some((r) =&gt; hasRole(r));&#13;&#10;  const hasAnyPerm = permissions.length === 0 || permissions.some((p) =&gt; hasPermission(p));&#13;&#10;&#13;&#10;  if (hasAnyRole || hasAnyPerm) return children;&#13;&#10;&#13;&#10;  return &lt;Navigate to=&quot;/unauthorized&quot; replace /&gt;;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/utils/route-guard/AuthGuard.jsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/utils/route-guard/AuthGuard.jsx" />
              <option name="originalContent" value="import PropTypes from 'prop-types';&#10;import { useEffect } from 'react';&#10;import { useNavigate, useLocation } from 'react-router-dom';&#10;&#10;// project imports&#10;import Loader from 'components/Loader';&#10;import { useAuth } from 'modules/auth/useAuth';&#10;&#10;// ==============================|| AUTH GUARD ||============================== //&#10;&#10;export default function AuthGuard({ children }) {&#10;  const { isAuthenticated, user } = useAuth();&#10;  const navigate = useNavigate();&#10;  const location = useLocation();&#10;&#10;  useEffect(() =&gt; {&#10;    if (user !== undefined &amp;&amp; !isAuthenticated) {&#10;      navigate('/auth/login', {&#10;        state: {&#10;          from: location.pathname&#10;        },&#10;        replace: true&#10;      });&#10;    }&#10;  }, [isAuthenticated, user, navigate, location]);&#10;&#10;  // Show loader while checking auth&#10;  if (user === undefined) {&#10;    return &lt;Loader /&gt;;&#10;  }&#10;&#10;  return children;&#10;}&#10;&#10;AuthGuard.propTypes = { children: PropTypes.any };&#10;" />
              <option name="updatedContent" value="import PropTypes from 'prop-types';&#13;&#10;import { useEffect } from 'react';&#13;&#10;import { useNavigate, useLocation } from 'react-router-dom';&#13;&#10;&#13;&#10;// project imports&#13;&#10;import Loader from 'components/Loader';&#13;&#10;import { useAuth } from 'modules/auth/useAuth';&#13;&#10;&#13;&#10;// ==============================|| AUTH GUARD ||============================== //&#13;&#10;&#13;&#10;export default function AuthGuard({ children }) {&#13;&#10;  const { isAuthenticated, loading } = useAuth();&#13;&#10;  const navigate = useNavigate();&#13;&#10;  const location = useLocation();&#13;&#10;&#13;&#10;  useEffect(() =&gt; {&#13;&#10;    // Wait until auth initialization completes before redirecting&#13;&#10;    if (!loading &amp;&amp; !isAuthenticated) {&#13;&#10;      navigate('/auth/login', {&#13;&#10;        state: {&#13;&#10;          from: location.pathname&#13;&#10;        },&#13;&#10;        replace: true&#13;&#10;      });&#13;&#10;    }&#13;&#10;  }, [isAuthenticated, loading, navigate, location]);&#13;&#10;&#13;&#10;  // Show loader while checking auth&#13;&#10;  if (loading) {&#13;&#10;    return &lt;Loader /&gt;;&#13;&#10;  }&#13;&#10;&#13;&#10;  return children;&#13;&#10;}&#13;&#10;&#13;&#10;AuthGuard.propTypes = { children: PropTypes.any };" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>